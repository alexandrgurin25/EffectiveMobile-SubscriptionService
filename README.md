# Subscription Service

**Сервис подписок** — это проект, разработанный в рамках [тестового задания](https://github.com/user-attachments/files/22949925/Junior.GO.2.pdf) на позицию Junior Golang Developer в компанию Effective Mobile. 
Данный сервис представляет собой REST-сервис для управления записями о подписках пользователей на онлайн-сервисы. Сервис позволяет осуществлять CRUDL-операции (создание, чтение, обновление, удаление, список) и подсчет суммарной стоимости подписок за указанный период.

## Стек технологий
- **Язык программирования:** Go
- **База данных:** PostgreSQL
- **Docker:** Используется для контейнеризации приложения
- **Postman:** Используется для проверки запросов
- **Migrate:** Для управления миграциями базы данных.
- **Zap:** Логирование.
- **Chi:** Роутер для HTTP сервера.
- **Cleanenv:** Для работы с переменными окружения.
- **gomock:** Для мокирования в тестах.
- **Swagger** Для документации.


## Эндпоинты
- `POST /api/subscriptions/`: Создание новой подписки.
- `GET /api/subscriptions/`: Получение списка подписок.
- `GET /api/subscriptions/{id}`: Получение подписки по ID.
- `PUT /api/subscriptions/{id}`: Обновление подписки по ID.
- `DELETE /api/subscriptions/{id}`: Удаление подписки по ID.
- `GET /api/subscriptions/summary/{user_id}/{service_name}`: Получение суммарной стоимости подписок для конкретного пользователя и сервиса.

## Установка и запуск

1. **Клонирование репозитория**:

   ```bash
   git clone git@github.com:alexandrgurin25/EffectiveMobile-SubscriptionService.git
   cd .\EffectiveMobile-Subscriptions\

2. **Запуск с использованием Docker Compose**:
   ```bash
   docker-compose up
   ```
3. **Доступ к Swagger Документации** <br>
   После успешного запуска сервиса, вы можете получить доступ к интерактивной документации API через Swagger. Для этого откройте веб-браузер и введите следующий адрес:
   ```bash
   http://localhost:8080/swagger/index.html
   ```
**Пояснение**
- Код сервиса полностью покрыт логами, что позволяет отслеживать статус и тело любых запросов. Это облегчает отладку и мониторинг работы приложения в реальном времени.
- Переменные окружения (env) сделаны публичными для удобства тестирования. Это позволяет легко модифицировать параметры и проверять функционал без необходимости изменять код.
- Сгенерированы мок-объекты для интерфейса DB, абстрагирующего pgxpool.Pool, и для pgx.Row. Это позволяет тестировать код без зависимости от реальной базы данных, делая тесты более быстрыми и независимыми от окружения.
- Юнит-тестами покрыт слой сервисов и репозитория, что гарантирует целостность логики приложения. Это важно для поддержки и расширения функционала, позволяя вносить изменения без риска нарушения работы приложения.
- Для эндпоинта `/api/subscriptions/` реализована пагинация. Можно добавлять запросы с дополнительными параметрами, такими как:
  - `page` — номер страницы
  - `limit` — количество записей на странице.
  - `user_id` — фильтрация по ID пользователя.
  - `service_name` — фильтрация по названию сервиса.
- Для повышения производительности запросов к базе данных были добавлены индексы на таблицу подписок. 
